/* components/cart-toast/index.scss */
@import '../../styles/variables.scss';
@import '../../styles/mixins.scss';

.cart-toast {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 9999;
  opacity: 0;
  visibility: hidden;
  transition: all $transition-duration-base $transition-timing-function;
  
  &.show {
    opacity: 1;
    visibility: visible;
    animation: toastShow 0.3s $transition-timing-function;
  }
}

.toast-content {
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(10rpx);
  border-radius: $border-radius-lg;
  padding: $padding-lg;
  @include flex-center;
  @include flex-column;
  gap: $margin-sm;
  min-width: 200rpx;
  max-width: 400rpx;
  box-shadow: 0 8rpx 32rpx rgba(0, 0, 0, 0.3);
}

.toast-icon {
  font-size: 48rpx;
  margin-bottom: $margin-xs;
}

.icon-cart {
  display: block;
  animation: cartBounce 0.6s ease-out;
}

.toast-message {
  text-align: center;
}

.message-text {
  color: $text-white;
  font-size: $font-size-base;
  font-weight: $font-weight-medium;
  line-height: 1.4;
}

/* 成功动画 */
.toast-animation {
  margin-top: $margin-xs;
}

.success-checkmark {
  width: 56rpx;
  height: 56rpx;
  border-radius: 50%;
  display: block;
  stroke-width: 4rpx;
  stroke: $success-color;
  stroke-miterlimit: 10;
  box-shadow: inset 0 0 0 $success-color;
  animation: checkmarkFill 0.4s ease-in-out 0.4s forwards, checkmarkScale 0.3s ease-in-out 0.9s both;
  position: relative;
}

.success-checkmark .check-icon {
  width: 56rpx;
  height: 56rpx;
  position: relative;
  border-radius: 50%;
  box-sizing: content-box;
  border: 4rpx solid $success-color;
}

.success-checkmark .check-icon::before {
  top: 6rpx;
  left: -4rpx;
  width: 60rpx;
  height: 120rpx;
  border-radius: 120rpx 0 0 120rpx;
  transform: rotate(-45deg);
  transform-origin: 60rpx 60rpx;
  content: '';
  position: absolute;
  background-color: rgba(0, 0, 0, 0.8);
  animation: checkmarkRotate 0.25s ease-in-out 0.7s both;
}

.success-checkmark .check-icon::after {
  top: 16rpx;
  left: 60rpx;
  width: 60rpx;
  height: 120rpx;
  border-radius: 0 120rpx 120rpx 0;
  transform: rotate(-45deg);
  transform-origin: 0 60rpx;
  content: '';
  position: absolute;
  background-color: rgba(0, 0, 0, 0.8);
  animation: checkmarkRotate 0.25s ease-in-out 0.9s both;
}

.success-checkmark .icon-line {
  height: 6rpx;
  background-color: $success-color;
  display: block;
  border-radius: 4rpx;
  position: absolute;
  z-index: 10;
}

.success-checkmark .icon-line.line-tip {
  top: 46rpx;
  left: 28rpx;
  width: 50rpx;
  transform: rotate(45deg);
  animation: checkmarkIcon 0.25s ease-in-out 1.2s both;
}

.success-checkmark .icon-line.line-long {
  top: 38rpx;
  right: 16rpx;
  width: 100rpx;
  transform: rotate(-45deg);
  animation: checkmarkIcon 0.25s ease-in-out 1.4s both;
}

.success-checkmark .icon-circle {
  top: -8rpx;
  left: -8rpx;
  z-index: 10;
  width: 120rpx;
  height: 120rpx;
  border-radius: 50%;
  position: absolute;
  box-sizing: content-box;
  border: 8rpx solid rgba(76, 175, 80, 0.5);
}

.success-checkmark .icon-fix {
  top: 16rpx;
  width: 10rpx;
  height: 85rpx;
  position: absolute;
  left: 52rpx;
  z-index: 1;
  background-color: rgba(0, 0, 0, 0.8);
  transform: rotate(-45deg);
}

/* 动画定义 */
@keyframes toastShow {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
  100% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}

@keyframes cartBounce {
  0%, 20%, 53%, 80%, 100% {
    transform: translate3d(0, 0, 0);
  }
  40%, 43% {
    transform: translate3d(0, -30rpx, 0);
  }
  70% {
    transform: translate3d(0, -15rpx, 0);
  }
  90% {
    transform: translate3d(0, -4rpx, 0);
  }
}

@keyframes checkmarkRotate {
  0% {
    height: 0;
  }
  100% {
    height: 250rpx;
  }
}

@keyframes checkmarkIcon {
  0% {
    width: 0;
    left: 28rpx;
    top: 46rpx;
  }
  50% {
    width: 0;
    left: 28rpx;
    top: 46rpx;
  }
  100% {
    width: 50rpx;
    left: 28rpx;
    top: 46rpx;
  }
}

@keyframes checkmarkFill {
  100% {
    box-shadow: inset 0 0 0 60rpx $success-color;
  }
}

@keyframes checkmarkScale {
  0%, 100% {
    transform: none;
  }
  50% {
    transform: scale3d(1.1, 1.1, 1);
  }
}

/* 响应式设计 */
@include respond-to(sm) {
  .toast-content {
    padding: $padding-md;
    min-width: 180rpx;
    max-width: 350rpx;
  }
  
  .toast-icon {
    font-size: 40rpx;
  }
  
  .message-text {
    font-size: $font-size-sm;
  }
  
  .success-checkmark {
    width: 48rpx;
    height: 48rpx;
  }
}

/* 无障碍支持 */
@media (prefers-reduced-motion: reduce) {
  .cart-toast,
  .icon-cart,
  .success-checkmark,
  .success-checkmark .check-icon::before,
  .success-checkmark .check-icon::after,
  .success-checkmark .icon-line {
    animation: none;
    transition: none;
  }
  
  .cart-toast.show {
    opacity: 1;
    visibility: visible;
    transform: translate(-50%, -50%) scale(1);
  }
}

/* 高对比度模式支持 */
@media (prefers-contrast: high) {
  .toast-content {
    background: rgba(0, 0, 0, 0.95);
    border: 2rpx solid $text-white;
  }
  
  .success-checkmark .check-icon {
    border-color: $text-white;
  }
  
  .success-checkmark .icon-line {
    background-color: $text-white;
  }
}